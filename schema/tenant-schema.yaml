schemaVersion: v1

# ------------------------
# Global / mandatory fields
# ------------------------
tenant:
  type: string
  required: true
  description: Tenant / Business Unit name

env:
  type: string
  required: true
  allowed:
    - dev
    - test
    - prod

jenkins:
  required: false
  type: map
  schema:
    url:
      type: string
      required: true

    user:
      type: string
      required: true

    token:
      type: string
      required: true

    job_name:
      type: string
      required: true

region:
  type: string
  required: true
  description: AWS region for deployment
  allowed:
    - us-east-1
    - ap-south-1

admin_principal_arn:
  type: string
  required: true
  description: admin_principal_arn

account_id:
  type: string
  required: true
  description: account_id


description:
  type: string
  required: false
  description: dsdsfsfsd

# ------------------------
# Services catalog (Phase 1)
# ------------------------
services:
  # type: string
  # required: true
  # description: AWS region for deployment

  vpc:
    enabled:
      type: boolean
      required: true
    config:
      type: map
      required: true
      description: Multiple VPC definitions

      schema:
        vpc_cidr:
          type: string
          required: true
          description: CIDR block for VPC

  # eks:
  #   enabled:
  #     type: boolean
  #     required: true

  #   config:
  #     type: map
  #     required: true
  #     description: Multiple VPC definitions

  #     schema:
  #       vpc_name:
  #         type: string
  #         required: true
  #         description: Name of VPC to attach this EKS cluster to
          
  #       version:
  #         type: string
  #         required: false
  #         allowed:
  #           - "1.28"
  #           - "1.29"
  #         description: Kubernetes version for EKS

  #       node_groups:
  #         type: map
  #         required: false
  #         description: EKS managed node groups

  #         schema:
  #           instance_types:
  #             type: list
  #             required: true

  #           min:
  #             type: number
  #             required: true
  #             min: 1

  #           max:
  #             type: number
  #             required: true
  #             min: 1

  #           desired:
  #             type: number
  #             required: true
  #             min: 1

  eks:
    type: map
    required: false
    schema:
      enabled:
        type: boolean
        required: true

      config:
        type: map
        required: false
        schema:
          fleet:
            type: string
            required: true

          version:
            type: string
            required: true

          is_canary:
            type: boolean
            required: false

          vpc_name:
            type: string
            required: false

          node_groups:
            type: map
            required: false
            schema:
              instance_types:
                type: map
                required: false

              min:
                type: number
                required: false

              max:
                type: number
                required: false

              desired:
                type: number
                required: false

  dynamodb:
    enabled:
      type: boolean
      required: true

    config:
      type: map
      required: true
      description: DynamoDB tables to create

      schema:
        table_name:
          type: string
          required: true
          description: Name of the DynamoDB table

        billing_mode:
          type: string
          required: false
          allowed:
            - "PAY_PER_REQUEST"
            - "PROVISIONED"
          description: DynamoDB billing mode

        point_in_time_recovery:
          type: boolean
          required: false
          description: Enable point-in-time recovery              